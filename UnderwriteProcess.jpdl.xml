<?xml version="1.0" encoding="UTF-8"?>

<process xmlns="http://jbpm.org/4.0/jpdl"  name="UnderwriteProcess">
	<start>
		<transition name="To start Position" to="NB without Quotation"></transition>
	</start>
	
	<!--<task name="New Business Takeon" 
        assignee="#{order}">
     <transition name="To NB Decision" to="NB without Quotation"></transition>
    </task>.-->
	
	<decision name="NB without Quotation" expr="#{UWStart}">
	    <transition name="Yes" to="Client Exists"/>
	    <transition name="No" to="Convert Quotation"/>
	</decision>
	
	<decision name="Client Exists" expr="#{Client}">
	    <transition name="Yes" to="New Business Data Entry"/>
	    <transition name="No" to="Create Quotation Client"/>
	</decision>
	
	<task name="Convert Quotation" 
        assignee="#{order}">
      <transition name="Start Underwriting" to="Underwrite Policy"></transition>
    </task>

	
	<task name="Create Quotation Client" 
        assignee="#{order}">
     <transition name="To Data Entry" to="New Business Data Entry"></transition>
    </task>

    <task name="New Business Data Entry" 
        assignee="#{order}">
     <transition name="Start Underwriting" to="Underwrite Policy"></transition>
    </task>
	
	 <task name="Underwrite Policy" 
        assignee="#{order}">
     <transition name="credit" to="Credit Terms"></transition>
    </task>
	
<!--	<task name="Verify Policy Details" 
        assignee="#{order}">
     <transition name="Make Ready" to="Make Ready for Authorisation"></transition>
    </task> 
	
	<task name="Make Ready for Authorisation" 
        assignee="#{order}">
		<transition name="credit" to="Credit Terms"></transition>
    </task> -->
	
	<decision name="Credit Terms" expr="#{Credit}">
	    <transition name="Yes" to="Next Transition"/>
	    <transition name="No" to="Wait for Payment"/>
	</decision>
	
	
	
	<task name="Wait for Payment" 
        assignee="#{order}">
     <transition name="Determine Transition" to="Next Transition"></transition>
    </task>
	
	<decision name="Next Transition" expr="#{NextTrans}">
	    <transition name="A" to="Reinsurance Medical Underwriting"/>
	    <transition name="N" to="Authorise Policy"/>
		<transition name="M" to="Medical Underwriting"/>
		<transition name="R" to="Perform Reinsurance"/>
	</decision>
	
<!--	<task name="Reinsurance Medical Underwriting" 
        assignee="#{order}">
     <transition name="Do Reisure Medicals" to="Reinsurance Medicals"></transition>
    </task>-->
	
	<fork name="Reinsurance Medical Underwriting">
      <transition name="Reinsure" to="Perform Reinsurance" />
      <transition name="Medicals" to="Medical Underwriting"/>
   </fork>
	
	<task name="Perform Reinsurance" 
        assignee="#{order}">
     <transition name="Ri medicals" to="Reinsurer Medicals"></transition>
    </task>
	<decision name="Reinsurer Medicals" expr="#{riMedicals}">
	    <transition name="Y" to="Refer to Reinsurer"/>
	    <transition name="N" to="Policy Join"/>
	</decision>
	<task name="Refer to Reinsurer" 
        assignee="#{order}">
      <transition name="medical received" to="Policy Join"></transition>
    </task>
	
	<task name="Medical Underwriting" 
        assignee="#{order}">
      <transition name="Complete Process" to="Policy Join"></transition>
    </task>
	
	<join name="Policy Join" >
      <transition name="auth Policy" to="Authorise Policy" />
   </join> 
	
	<task name="Authorise Policy" 
        assignee="#{order}">
     <transition name="disp Documents" to="Dispatch Policy Documents"></transition>
    </task>
	
	<task name="Dispatch Policy Documents" 
        assignee="#{order}">
     <transition name="end Policy" to="post reinsure"></transition>
    </task>
    
    <decision name="post reinsure" expr="#{performRein}">
	    <transition name="Y" to="Perform reinsurance"/>
	    <transition name="N" to="End-Policy-Process"/>
   </decision>
  
    <task name="Perform reinsurance" 
        assignee="#{order}">
     <transition name="Complete Process" to="End-Policy-Process"></transition>
    </task>
	  
	<end name="End-Policy-Process"></end>
</process>